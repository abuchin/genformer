
global batch size: 8
WARNING:tensorflow:From /opt/conda/lib/python3.7/site-packages/tensorflow/python/autograph/pyct/static_analysis/liveness.py:83: Analyzer.lamba_check (from tensorflow.python.autograph.pyct.static_analysis.liveness) is deprecated and will be removed after 2023-09-23.
Instructions for updating:
Lambda fuctions will be no more assumed to be used in the statement where they are used, or at least in the same block. https://github.com/tensorflow/tensorflow/issues/56089
WARNING:tensorflow:From /opt/conda/lib/python3.7/site-packages/tensorflow/python/autograph/pyct/static_analysis/liveness.py:83: Analyzer.lamba_check (from tensorflow.python.autograph.pyct.static_analysis.liveness) is deprecated and will be removed after 2023-09-23.
Instructions for updating:
Lambda fuctions will be no more assumed to be used in the statement where they are used, or at least in the same block. https://github.com/tensorflow/tensorflow/issues/56089
created dataset iterators
loaded enformer conv weights
[34m[1mwandb[39m[22m: [33mWARNING[39m Config item 'filter_list_seq' was locked by 'sweep' (ignored update).
{'BN_momentum': 0.9, 'atac_mask_dropout': 0.15, 'decay_frac': 0.5, 'dropout_rate': 0.05, 'epsilon': 1e-14, 'filter_list_atac': [32, 64], 'filter_list_seq': [384, 512, 640, 768, 896, 1024], 'final_output_length': 896, 'freeze_conv_layers': False, 'gradient_clip': 5, 'input_length': 196608, 'kernel_transformation': 'relu_kernel_transformation', 'learnable_PE': True, 'load_init': False, 'log_atac': True, 'lr_base1': 5e-06, 'lr_base2': 0.00025, 'num_heads': 8, 'num_random_features': 256, 'num_transformer_layers': 2, 'optimizer': 'adabelief', 'output_length': 1536, 'output_length_ATAC': 49152, 'output_res': 128, 'pointwise_dropout_rate': 0.1, 'rectify': True, 'sonnet_weights_bool': True, 'stable_variant': False, 'wd_1_frac': 0, 'wd_2_frac': 0, 'lr_base': 0.01, 'tpu': 'node-2', 'gcs_path': 'gs://picard-testing-176520/genformer_atac_pretrain/196k/genformer_atac_pretrain_globalacc_conv_rpgc', 'gcs_path_holdout': 'gs://picard-testing-176520/genformer_atac_pretrain/196k/genformer_atac_pretrain_globalacc_conv_rpgc_holdout', 'num_epochs': 100, 'train_examples': 1000, 'val_examples': 250, 'val_examples_ho': 150, 'batch_size': 1, 'warmup_frac': 0.005, 'patience': 50, 'min_delta': 5e-06, 'model_save_dir': 'gs://picard-testing-176520/genformer_atac_pretrain/models', 'model_save_basename': 'aformer_baseline', 'max_shift': 10, 'inits_type': 'enformer_conv', 'crop_size': 320, 'train_steps': 125, 'val_steps': 31, 'val_steps_ho': 18, 'total_steps': 125}
initialized model
building model
/opt/conda/lib/python3.7/site-packages/keras/initializers/initializers_v2.py:121: UserWarning: The initializer RandomUniform is unseeded and being called multiple times, which will return identical values  each time (even if the initializer is unseeded). Please update your code to provide a seed to the initializer, or avoid using the same initalizer instance more than once.
  f"The initializer {self.__class__.__name__} is unseeded "
built model
total params: tf.Tensor(41549157, shape=(), dtype=int32)
starting epoch_ 1
completed epoch 1
train_loss: -1.3343217
training duration(mins): 2.944404649734497
val_loss: -2.3470376
human_ATAC_pearsons: 0.19373678
human_ATAC_R2: -0.0063141584
human_ATAC_pearsons_ho: 0.21027601
human_ATAC_R2_ho: -0.013417959
completed epoch 1 validation
validation duration(mins): 1.5562805215517679
patience counter at: 0
starting epoch_ 2
completed epoch 2
train_loss: -2.2469454
training duration(mins): 2.480279537041982
val_loss: -2.4248803
human_ATAC_pearsons: 0.35109666
human_ATAC_R2: 0.005081713
human_ATAC_pearsons_ho: 0.38866204
human_ATAC_R2_ho: 0.004266739
completed epoch 2 validation
validation duration(mins): 1.5108271916707356
patience counter at: 0
starting epoch_ 3
completed epoch 3
train_loss: -2.3128035
training duration(mins): 2.485794440905253
val_loss: -2.2857604
human_ATAC_pearsons: 0.22607094
human_ATAC_R2: 0.0073868036
human_ATAC_pearsons_ho: 0.27560332
human_ATAC_R2_ho: 0.0004298091
completed epoch 3 validation
validation duration(mins): 1.5174376010894775
check whether early stopping/save criteria met
patience counter at: 1
starting epoch_ 4
completed epoch 4
train_loss: -2.488581
training duration(mins): 2.5047070384025574
val_loss: -2.6712253
human_ATAC_pearsons: 0.28143772
human_ATAC_R2: 0.006081164
human_ATAC_pearsons_ho: 0.36338863
human_ATAC_R2_ho: 0.01621288
completed epoch 4 validation
validation duration(mins): 1.5363643765449524
check whether early stopping/save criteria met
Saving model...
patience counter at: 0
starting epoch_ 5
completed epoch 5
train_loss: -2.5399358
training duration(mins): 2.484996795654297
val_loss: -2.5860996
human_ATAC_pearsons: 0.23900191
human_ATAC_R2: 0.006905794
human_ATAC_pearsons_ho: 0.31143528
human_ATAC_R2_ho: 0.010838389
completed epoch 5 validation
validation duration(mins): 1.569019881884257
check whether early stopping/save criteria met
patience counter at: 1
starting epoch_ 6
completed epoch 6
train_loss: -2.3497715
training duration(mins): 2.4603979070981343
val_loss: -2.744846
human_ATAC_pearsons: 0.21219416
human_ATAC_R2: 0.006456077
human_ATAC_pearsons_ho: 0.40544176
human_ATAC_R2_ho: 0.0065996647
completed epoch 6 validation
validation duration(mins): 1.5275094389915467
check whether early stopping/save criteria met
Saving model...
patience counter at: 0
starting epoch_ 7
completed epoch 7
train_loss: -2.3902755
training duration(mins): 2.501643478870392
val_loss: -2.6640108
human_ATAC_pearsons: 0.15414177
human_ATAC_R2: 0.00026518106
human_ATAC_pearsons_ho: 0.29088756
human_ATAC_R2_ho: 0.0046315193
completed epoch 7 validation
validation duration(mins): 1.556969400246938
check whether early stopping/save criteria met
patience counter at: 1
starting epoch_ 8
completed epoch 8
train_loss: -2.2895553
training duration(mins): 2.5279303153355914
val_loss: -3.0551925
human_ATAC_pearsons: 0.34352344
human_ATAC_R2: 0.020765662
human_ATAC_pearsons_ho: 0.31713843
human_ATAC_R2_ho: 0.010630965
completed epoch 8 validation
validation duration(mins): 1.5516142010688783
check whether early stopping/save criteria met
Saving model...
patience counter at: 0
starting epoch_ 9
completed epoch 9
train_loss: -2.2908576
training duration(mins): 2.545378124713898
val_loss: -0.6788182
human_ATAC_pearsons: 0.16643111
human_ATAC_R2: -0.015912533
human_ATAC_pearsons_ho: 0.27467614
human_ATAC_R2_ho: -0.0046545267
completed epoch 9 validation
validation duration(mins): 1.5877036571502685
check whether early stopping/save criteria met
patience counter at: 1
starting epoch_ 10
completed epoch 10
train_loss: -2.5460007
training duration(mins): 2.475212355454763
val_loss: -2.6770632
human_ATAC_pearsons: 0.23526165
human_ATAC_R2: -0.005513668
human_ATAC_pearsons_ho: 0.45293078
human_ATAC_R2_ho: 0.0015537739
completed epoch 10 validation
validation duration(mins): 1.55887375275294
check whether early stopping/save criteria met
Saving model...
patience counter at: 2
starting epoch_ 11
completed epoch 11
train_loss: -2.2313194
training duration(mins): 2.491815427939097
[34m[1mwandb[39m[22m: Ctrl + C detected. Stopping sweep.
Exception ignored in: <module 'threading' from '/opt/conda/lib/python3.7/threading.py'>
Traceback (most recent call last):
  File "/opt/conda/lib/python3.7/threading.py", line 1307, in _shutdown
    lock.acquire()
KeyboardInterrupt