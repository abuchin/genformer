2022-08-30 23:40:04,025 INFO    Thread-2  :3025 [wandb_setup.py:_flush():76] Configure stats pid to 3025
2022-08-30 23:40:04,025 INFO    Thread-2  :3025 [wandb_setup.py:_flush():76] Loading settings from /home/jupyter/.config/wandb/settings
2022-08-30 23:40:04,025 INFO    Thread-2  :3025 [wandb_setup.py:_flush():76] Loading settings from wandb/settings
2022-08-30 23:40:04,026 INFO    Thread-2  :3025 [wandb_setup.py:_flush():76] Loading settings from environment variables: {'_require_service': 'True', 'project': 'aformer_initial_run', 'entity': 'njaved', 'root_dir': '/home/jupyter/dev/aformer', 'sweep_id': 'gb9z2m7p', 'run_id': 'ao2a7m0s', 'sweep_param_path': '/home/jupyter/dev/aformer/wandb/sweep-gb9z2m7p/config-ao2a7m0s.yaml'}
2022-08-30 23:40:04,026 INFO    Thread-2  :3025 [wandb_setup.py:_flush():76] Inferring run settings from compute environment: {'program_relpath': 'train_model_aformer_TF_genecentered_separated.py', 'program': 'train_model_aformer_TF_genecentered_separated.py'}
2022-08-30 23:40:04,026 INFO    Thread-2  :3025 [wandb_init.py:_log_setup():461] Logging user logs to /home/jupyter/dev/aformer/wandb/run-20220830_234004-ao2a7m0s/logs/debug.log
2022-08-30 23:40:04,026 INFO    Thread-2  :3025 [wandb_init.py:_log_setup():462] Logging internal logs to /home/jupyter/dev/aformer/wandb/run-20220830_234004-ao2a7m0s/logs/debug-internal.log
2022-08-30 23:40:04,026 INFO    Thread-2  :3025 [wandb_init.py:init():495] calling init triggers
2022-08-30 23:40:04,026 INFO    Thread-2  :3025 [wandb_init.py:init():499] wandb.init called with sweep_config: {'beta1': 0.9, 'beta2': 0.999, 'bottleneck_units': 32, 'bottleneck_units_tf': 32, 'conv_channel_list': [48, 48, 56, 56, 64, 64], 'conv_filter_size_1_atac': 15, 'conv_filter_size_1_seq': 15, 'conv_filter_size_2_atac': 5, 'conv_filter_size_2_seq': 5, 'dim': 32, 'dropout': 0.25, 'epsilon': 1e-10, 'fft_prior_scale': 0.2, 'freq_limit_scale': 0.07, 'gradient_clip': 0.2, 'hidden_size': 128, 'input_length': 16384, 'kernel_regularizer': 0, 'kernel_transformation': 'relu_kernel_transformation', 'lr_base': 5e-06, 'min_lr': 5e-07, 'momentum': 0.9, 'num_heads': 4, 'num_random_features': 128, 'num_transformer_layers': 2, 'optimizer': 'adamw', 'organisms': 'hg', 'precision': 'mixed_bfloat16', 'rectify': 'True', 'rel_pos_bins': 512, 'use_fft_prior': True, 'use_tf_acc': False, 'weight_decay_frac': 1e-05}
config: {'lr_base': 0.01}
2022-08-30 23:40:04,026 INFO    Thread-2  :3025 [wandb_init.py:init():548] starting backend
2022-08-30 23:40:04,026 INFO    Thread-2  :3025 [wandb_init.py:init():552] setting up manager
2022-08-30 23:40:04,033 INFO    Thread-2  :3025 [backend.py:_multiprocessing_setup():99] multiprocessing start_methods=fork,spawn,forkserver, using: spawn
2022-08-30 23:40:04,039 INFO    Thread-2  :3025 [wandb_init.py:init():558] backend started and connected
2022-08-30 23:40:04,046 INFO    Thread-2  :3025 [wandb_run.py:_config_callback():1152] config_cb None None {'beta1': 0.9, 'beta2': 0.999, 'bottleneck_units': 32, 'bottleneck_units_tf': 32, 'conv_channel_list': [48, 48, 56, 56, 64, 64], 'conv_filter_size_1_atac': 15, 'conv_filter_size_1_seq': 15, 'conv_filter_size_2_atac': 5, 'conv_filter_size_2_seq': 5, 'dim': 32, 'dropout': 0.25, 'epsilon': 1e-10, 'fft_prior_scale': 0.2, 'freq_limit_scale': 0.07, 'gradient_clip': 0.2, 'hidden_size': 128, 'input_length': 16384, 'kernel_regularizer': 0, 'kernel_transformation': 'relu_kernel_transformation', 'lr_base': 5e-06, 'min_lr': 5e-07, 'momentum': 0.9, 'num_heads': 4, 'num_random_features': 128, 'num_transformer_layers': 2, 'optimizer': 'adamw', 'organisms': 'hg', 'precision': 'mixed_bfloat16', 'rectify': 'True', 'rel_pos_bins': 512, 'use_fft_prior': True, 'use_tf_acc': False, 'weight_decay_frac': 1e-05}
2022-08-30 23:40:04,050 INFO    Thread-2  :3025 [wandb_init.py:init():636] updated telemetry
2022-08-30 23:40:04,075 INFO    Thread-2  :3025 [wandb_init.py:init():668] communicating run to backend with 30 second timeout
2022-08-30 23:40:04,183 INFO    Thread-2  :3025 [wandb_run.py:_on_init():1982] communicating current version
2022-08-30 23:40:04,261 INFO    Thread-2  :3025 [wandb_run.py:_on_init():1986] got version response upgrade_message: "wandb version 0.13.2 is available!  To upgrade, please run:\n $ pip install wandb --upgrade"

2022-08-30 23:40:04,261 INFO    Thread-2  :3025 [wandb_init.py:init():700] starting run threads in backend
2022-08-30 23:40:09,279 INFO    Thread-2  :3025 [wandb_run.py:_console_start():1962] atexit reg
2022-08-30 23:40:09,279 INFO    Thread-2  :3025 [wandb_run.py:_redirect():1820] redirect: SettingsConsole.WRAP_RAW
2022-08-30 23:40:09,280 INFO    Thread-2  :3025 [wandb_run.py:_redirect():1885] Wrapping output streams.
2022-08-30 23:40:09,280 INFO    Thread-2  :3025 [wandb_run.py:_redirect():1907] Redirects installed.
2022-08-30 23:40:09,281 INFO    Thread-2  :3025 [wandb_init.py:init():732] run started, returning control to user process
2022-08-30 23:40:09,282 INFO    Thread-2  :3025 [wandb_config.py:__setitem__():149] config set tpu = node-23 - <bound method Run._config_callback of <wandb.sdk.wandb_run.Run object at 0x7ff3f7a0df90>>
2022-08-30 23:40:09,282 INFO    Thread-2  :3025 [wandb_run.py:_config_callback():1152] config_cb tpu node-23 None
2022-08-30 23:40:09,283 INFO    Thread-2  :3025 [wandb_config.py:__setitem__():149] config set gcs_path = gs://picard-testing-176520/16k_genecentered_blacklist0.50_atacnormalized/preprocessed - <bound method Run._config_callback of <wandb.sdk.wandb_run.Run object at 0x7ff3f7a0df90>>
2022-08-30 23:40:09,283 INFO    Thread-2  :3025 [wandb_run.py:_config_callback():1152] config_cb gcs_path gs://picard-testing-176520/16k_genecentered_blacklist0.50_atacnormalized/preprocessed None
2022-08-30 23:40:09,283 INFO    Thread-2  :3025 [wandb_config.py:__setitem__():149] config set gcs_path_val_ho = gs://picard-testing-176520/16k_genecentered_blacklist0.50_atacnormalized/val_holdout/preprocessed/val - <bound method Run._config_callback of <wandb.sdk.wandb_run.Run object at 0x7ff3f7a0df90>>
2022-08-30 23:40:09,283 INFO    Thread-2  :3025 [wandb_run.py:_config_callback():1152] config_cb gcs_path_val_ho gs://picard-testing-176520/16k_genecentered_blacklist0.50_atacnormalized/val_holdout/preprocessed/val None
2022-08-30 23:40:09,284 INFO    Thread-2  :3025 [wandb_config.py:__setitem__():149] config set target_unit = logTPM - <bound method Run._config_callback of <wandb.sdk.wandb_run.Run object at 0x7ff3f7a0df90>>
2022-08-30 23:40:09,284 INFO    Thread-2  :3025 [wandb_run.py:_config_callback():1152] config_cb target_unit logTPM None
2022-08-30 23:40:09,284 INFO    Thread-2  :3025 [wandb_config.py:__setitem__():149] config set max_shift = 300 - <bound method Run._config_callback of <wandb.sdk.wandb_run.Run object at 0x7ff3f7a0df90>>
2022-08-30 23:40:09,284 INFO    Thread-2  :3025 [wandb_run.py:_config_callback():1152] config_cb max_shift 300 None
2022-08-30 23:40:09,284 INFO    Thread-2  :3025 [wandb_config.py:__setitem__():149] config set output_heads = hg - <bound method Run._config_callback of <wandb.sdk.wandb_run.Run object at 0x7ff3f7a0df90>>
2022-08-30 23:40:09,284 INFO    Thread-2  :3025 [wandb_run.py:_config_callback():1152] config_cb output_heads hg None
2022-08-30 23:40:09,285 INFO    Thread-2  :3025 [wandb_config.py:__setitem__():149] config set num_epochs = 30 - <bound method Run._config_callback of <wandb.sdk.wandb_run.Run object at 0x7ff3f7a0df90>>
2022-08-30 23:40:09,285 INFO    Thread-2  :3025 [wandb_run.py:_config_callback():1152] config_cb num_epochs 30 None
2022-08-30 23:40:09,285 INFO    Thread-2  :3025 [wandb_config.py:__setitem__():149] config set train_steps = 298 - <bound method Run._config_callback of <wandb.sdk.wandb_run.Run object at 0x7ff3f7a0df90>>
2022-08-30 23:40:09,285 INFO    Thread-2  :3025 [wandb_run.py:_config_callback():1152] config_cb train_steps 298 None
2022-08-30 23:40:09,286 INFO    Thread-2  :3025 [wandb_config.py:__setitem__():149] config set val_steps_h = 47 - <bound method Run._config_callback of <wandb.sdk.wandb_run.Run object at 0x7ff3f7a0df90>>
2022-08-30 23:40:09,286 INFO    Thread-2  :3025 [wandb_run.py:_config_callback():1152] config_cb val_steps_h 47 None
2022-08-30 23:40:09,286 INFO    Thread-2  :3025 [wandb_config.py:__setitem__():149] config set val_steps_ho = 6 - <bound method Run._config_callback of <wandb.sdk.wandb_run.Run object at 0x7ff3f7a0df90>>
2022-08-30 23:40:09,286 INFO    Thread-2  :3025 [wandb_run.py:_config_callback():1152] config_cb val_steps_ho 6 None
2022-08-30 23:40:09,286 INFO    Thread-2  :3025 [wandb_config.py:__setitem__():149] config set batch_size = 24 - <bound method Run._config_callback of <wandb.sdk.wandb_run.Run object at 0x7ff3f7a0df90>>
2022-08-30 23:40:09,286 INFO    Thread-2  :3025 [wandb_run.py:_config_callback():1152] config_cb batch_size 24 None
2022-08-30 23:40:09,287 INFO    Thread-2  :3025 [wandb_config.py:__setitem__():149] config set warmup_frac = 0.15 - <bound method Run._config_callback of <wandb.sdk.wandb_run.Run object at 0x7ff3f7a0df90>>
2022-08-30 23:40:09,287 INFO    Thread-2  :3025 [wandb_run.py:_config_callback():1152] config_cb warmup_frac 0.15 None
2022-08-30 23:40:09,287 INFO    Thread-2  :3025 [wandb_config.py:__setitem__():149] config set total_steps = 14900 - <bound method Run._config_callback of <wandb.sdk.wandb_run.Run object at 0x7ff3f7a0df90>>
2022-08-30 23:40:09,287 INFO    Thread-2  :3025 [wandb_run.py:_config_callback():1152] config_cb total_steps 14900 None
2022-08-30 23:40:09,288 INFO    Thread-2  :3025 [wandb_config.py:__setitem__():149] config set patience = 10 - <bound method Run._config_callback of <wandb.sdk.wandb_run.Run object at 0x7ff3f7a0df90>>
2022-08-30 23:40:09,288 INFO    Thread-2  :3025 [wandb_run.py:_config_callback():1152] config_cb patience 10 None
2022-08-30 23:40:09,288 INFO    Thread-2  :3025 [wandb_config.py:__setitem__():149] config set min_delta = 0.001 - <bound method Run._config_callback of <wandb.sdk.wandb_run.Run object at 0x7ff3f7a0df90>>
2022-08-30 23:40:09,288 INFO    Thread-2  :3025 [wandb_run.py:_config_callback():1152] config_cb min_delta 0.001 None
2022-08-30 23:40:09,289 INFO    Thread-2  :3025 [wandb_config.py:__setitem__():149] config set model_save_dir = gs://picard-testing-176520/16k_genecentered_blacklist0.50_atacnormalized/models - <bound method Run._config_callback of <wandb.sdk.wandb_run.Run object at 0x7ff3f7a0df90>>
2022-08-30 23:40:09,289 INFO    Thread-2  :3025 [wandb_run.py:_config_callback():1152] config_cb model_save_dir gs://picard-testing-176520/16k_genecentered_blacklist0.50_atacnormalized/models None
2022-08-30 23:40:09,289 INFO    Thread-2  :3025 [wandb_config.py:__setitem__():149] config set model_save_basename = aformer_initial_tests - <bound method Run._config_callback of <wandb.sdk.wandb_run.Run object at 0x7ff3f7a0df90>>
2022-08-30 23:40:09,289 INFO    Thread-2  :3025 [wandb_run.py:_config_callback():1152] config_cb model_save_basename aformer_initial_tests None
2022-08-30 23:40:09,290 INFO    Thread-2  :3025 [wandb_config.py:__setitem__():149] config set sync_period = 6 - <bound method Run._config_callback of <wandb.sdk.wandb_run.Run object at 0x7ff3f7a0df90>>
2022-08-30 23:40:09,290 INFO    Thread-2  :3025 [wandb_run.py:_config_callback():1152] config_cb sync_period 6 None
2022-08-30 23:40:09,290 INFO    Thread-2  :3025 [wandb_config.py:__setitem__():149] config set slow_step_frac = 0.5 - <bound method Run._config_callback of <wandb.sdk.wandb_run.Run object at 0x7ff3f7a0df90>>
2022-08-30 23:40:09,290 INFO    Thread-2  :3025 [wandb_run.py:_config_callback():1152] config_cb slow_step_frac 0.5 None
2022-08-30 23:40:09,290 INFO    Thread-2  :3025 [wandb_config.py:__setitem__():149] config set use_rot_emb = True - <bound method Run._config_callback of <wandb.sdk.wandb_run.Run object at 0x7ff3f7a0df90>>
2022-08-30 23:40:09,290 INFO    Thread-2  :3025 [wandb_run.py:_config_callback():1152] config_cb use_rot_emb True None
2022-08-30 23:40:09,291 INFO    Thread-2  :3025 [wandb_config.py:__setitem__():149] config set use_mask_pos = False - <bound method Run._config_callback of <wandb.sdk.wandb_run.Run object at 0x7ff3f7a0df90>>
2022-08-30 23:40:09,291 INFO    Thread-2  :3025 [wandb_run.py:_config_callback():1152] config_cb use_mask_pos False None
2022-08-30 23:40:09,294 INFO    Thread-2  :3025 [wandb_run.py:_config_callback():1152] config_cb None None {'train_steps': 1}
2022-08-30 23:40:09,294 INFO    Thread-2  :3025 [wandb_run.py:_config_callback():1152] config_cb None None {'val_steps_h': 1}
2022-08-30 23:40:09,295 INFO    Thread-2  :3025 [wandb_run.py:_config_callback():1152] config_cb None None {'val_steps_ho': 1}
2022-08-30 23:40:09,295 INFO    Thread-2  :3025 [wandb_run.py:_config_callback():1152] config_cb None None {'total_steps': 1}
2022-08-30 23:40:09,295 INFO    Thread-2  :3025 [wandb_run.py:_config_callback():1152] config_cb None None {'gcs_path': 'gs://picard-testing-176520/16k_genecentered_blacklist0.50_atacnormalized/preprocessed'}
2022-08-30 23:40:09,296 INFO    Thread-2  :3025 [wandb_run.py:_config_callback():1152] config_cb None None {'gcs_path_val_ho': 'gs://picard-testing-176520/16k_genecentered_blacklist0.50_atacnormalized/val_holdout/preprocessed/val'}
2022-08-30 23:40:09,296 INFO    Thread-2  :3025 [wandb_run.py:_config_callback():1152] config_cb None None {'model_save_dir': 'gs://picard-testing-176520/16k_genecentered_blacklist0.50_atacnormalized/models'}
2022-08-30 23:40:09,296 INFO    Thread-2  :3025 [wandb_run.py:_config_callback():1152] config_cb None None {'max_seq_length': 128}
2022-08-30 23:41:27,885 INFO    Thread-2  :3025 [wandb_run.py:_finish():1728] finishing run njaved/aformer_initial_run/ao2a7m0s
2022-08-30 23:41:27,887 INFO    Thread-2  :3025 [wandb_run.py:_atexit_cleanup():1931] got exitcode: 1
2022-08-30 23:41:27,887 INFO    Thread-2  :3025 [wandb_run.py:_restore():1914] restore
2022-08-30 23:41:27,887 INFO    Thread-2  :3025 [wandb_run.py:_restore():1920] restore done
2022-08-30 23:41:27,934 INFO    Thread-2  :3025 [wandb_run.py:_on_finish():2221] got exit ret: file_counts {
  wandb_count: 1
}
pusher_stats {
  uploaded_bytes: 2921
  total_bytes: 2921
}

2022-08-30 23:41:28,039 INFO    Thread-2  :3025 [wandb_run.py:_on_finish():2221] got exit ret: file_counts {
  wandb_count: 1
}
pusher_stats {
  uploaded_bytes: 2921
  total_bytes: 2921
}

2022-08-30 23:41:28,437 INFO    Thread-2  :3025 [wandb_run.py:_on_finish():2221] got exit ret: file_counts {
  wandb_count: 1
}
pusher_stats {
  uploaded_bytes: 2921
  total_bytes: 2921
}

2022-08-30 23:41:29,252 INFO    Thread-2  :3025 [wandb_run.py:_on_finish():2221] got exit ret: file_counts {
  wandb_count: 6
}
pusher_stats {
  uploaded_bytes: 2921
  total_bytes: 27505
}

2022-08-30 23:41:29,355 INFO    Thread-2  :3025 [wandb_run.py:_on_finish():2221] got exit ret: file_counts {
  wandb_count: 6
}
pusher_stats {
  uploaded_bytes: 27505
  total_bytes: 27505
}

2022-08-30 23:41:29,458 INFO    Thread-2  :3025 [wandb_run.py:_on_finish():2221] got exit ret: file_counts {
  wandb_count: 6
}
pusher_stats {
  uploaded_bytes: 27505
  total_bytes: 27505
}

2022-08-30 23:41:29,560 INFO    Thread-2  :3025 [wandb_run.py:_on_finish():2221] got exit ret: file_counts {
  wandb_count: 6
}
pusher_stats {
  uploaded_bytes: 27505
  total_bytes: 27505
}

2022-08-30 23:41:29,663 INFO    Thread-2  :3025 [wandb_run.py:_on_finish():2221] got exit ret: file_counts {
  wandb_count: 6
}
pusher_stats {
  uploaded_bytes: 27505
  total_bytes: 27505
}

2022-08-30 23:41:29,766 INFO    Thread-2  :3025 [wandb_run.py:_on_finish():2221] got exit ret: file_counts {
  wandb_count: 6
}
pusher_stats {
  uploaded_bytes: 27505
  total_bytes: 27505
}

2022-08-30 23:41:29,868 INFO    Thread-2  :3025 [wandb_run.py:_on_finish():2221] got exit ret: file_counts {
  wandb_count: 6
}
pusher_stats {
  uploaded_bytes: 27505
  total_bytes: 27505
}

2022-08-30 23:41:30,058 INFO    Thread-2  :3025 [wandb_run.py:_on_finish():2221] got exit ret: file_counts {
  wandb_count: 6
}
pusher_stats {
  uploaded_bytes: 27505
  total_bytes: 27505
}

2022-08-30 23:41:30,231 INFO    Thread-2  :3025 [wandb_run.py:_on_finish():2221] got exit ret: done: true
exit_result {
}
file_counts {
  wandb_count: 6
}
pusher_stats {
  uploaded_bytes: 27505
  total_bytes: 27505
}
local_info {
}

2022-08-30 23:41:31,338 INFO    Thread-2  :3025 [wandb_run.py:_footer_history_summary_info():3305] rendering history
2022-08-30 23:41:31,338 INFO    Thread-2  :3025 [wandb_run.py:_footer_history_summary_info():3337] rendering summary
2022-08-30 23:41:31,341 INFO    Thread-2  :3025 [wandb_run.py:_footer_sync_info():3261] logging synced files
