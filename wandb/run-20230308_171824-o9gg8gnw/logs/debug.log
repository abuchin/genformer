2023-03-08 17:18:24,528 INFO    Thread-2  :4529 [wandb_setup.py:_flush():76] Configure stats pid to 4529
2023-03-08 17:18:24,529 INFO    Thread-2  :4529 [wandb_setup.py:_flush():76] Loading settings from /home/jupyter/.config/wandb/settings
2023-03-08 17:18:24,529 INFO    Thread-2  :4529 [wandb_setup.py:_flush():76] Loading settings from wandb/settings
2023-03-08 17:18:24,529 INFO    Thread-2  :4529 [wandb_setup.py:_flush():76] Loading settings from environment variables: {'_require_service': 'True', 'project': 'test_paired_rampage_atac', 'entity': 'njaved', 'root_dir': '/home/jupyter/dev/aformer', 'sweep_id': 'sxfmbhgo', 'run_id': 'o9gg8gnw', 'sweep_param_path': '/home/jupyter/dev/aformer/wandb/sweep-sxfmbhgo/config-o9gg8gnw.yaml'}
2023-03-08 17:18:24,529 INFO    Thread-2  :4529 [wandb_setup.py:_flush():76] Inferring run settings from compute environment: {'program_relpath': 'train_model_atac_cage_early.py', 'program': 'train_model_atac_cage_early.py'}
2023-03-08 17:18:24,529 INFO    Thread-2  :4529 [wandb_init.py:_log_setup():461] Logging user logs to /home/jupyter/dev/aformer/wandb/run-20230308_171824-o9gg8gnw/logs/debug.log
2023-03-08 17:18:24,529 INFO    Thread-2  :4529 [wandb_init.py:_log_setup():462] Logging internal logs to /home/jupyter/dev/aformer/wandb/run-20230308_171824-o9gg8gnw/logs/debug-internal.log
2023-03-08 17:18:24,529 INFO    Thread-2  :4529 [wandb_init.py:init():495] calling init triggers
2023-03-08 17:18:24,529 INFO    Thread-2  :4529 [wandb_init.py:init():499] wandb.init called with sweep_config: {'BN_momentum': 0.9, 'atac_mask_dropout': 0.1, 'cage_scale': 0.5, 'decay_frac': 1, 'dropout_rate': 0.05, 'epsilon': 1e-08, 'filter_list_atac': [32, 64], 'filter_list_seq': [768, 896, 1024, 1152, 1280, 1536], 'final_output_length': 312, 'freeze_conv_layers': True, 'global_acc_size': 128, 'gradient_clip': 5, 'input_length': 65536, 'kernel_transformation': 'relu_kernel_transformation', 'learnable_PE': True, 'load_init': True, 'log_atac': True, 'loss_fn': 'poisson', 'lr_base1': 5e-06, 'lr_base2': 0.0001, 'num_heads': 4, 'num_random_features': 256, 'num_transformer_layers': 2, 'optimizer': 'adamw', 'output_length': 512, 'output_length_ATAC': 16384, 'output_res': 128, 'pointwise_dropout_rate': 0.1, 'predict_masked_atac_bool': True, 'rectify': True, 'sonnet_weights_bool': True, 'stable_variant': False, 'use_atac': True, 'use_global_acc': True, 'wd_1_frac': 0.001, 'wd_2_frac': 0.01}
config: {'lr_base': 0.01}
2023-03-08 17:18:24,529 INFO    Thread-2  :4529 [wandb_init.py:init():548] starting backend
2023-03-08 17:18:24,529 INFO    Thread-2  :4529 [wandb_init.py:init():552] setting up manager
2023-03-08 17:18:24,537 INFO    Thread-2  :4529 [backend.py:_multiprocessing_setup():99] multiprocessing start_methods=fork,spawn,forkserver, using: spawn
2023-03-08 17:18:24,544 INFO    Thread-2  :4529 [wandb_init.py:init():558] backend started and connected
2023-03-08 17:18:24,551 INFO    Thread-2  :4529 [wandb_run.py:_config_callback():1152] config_cb None None {'BN_momentum': 0.9, 'atac_mask_dropout': 0.1, 'cage_scale': 0.5, 'decay_frac': 1, 'dropout_rate': 0.05, 'epsilon': 1e-08, 'filter_list_atac': [32, 64], 'filter_list_seq': [768, 896, 1024, 1152, 1280, 1536], 'final_output_length': 312, 'freeze_conv_layers': True, 'global_acc_size': 128, 'gradient_clip': 5, 'input_length': 65536, 'kernel_transformation': 'relu_kernel_transformation', 'learnable_PE': True, 'load_init': True, 'log_atac': True, 'loss_fn': 'poisson', 'lr_base1': 5e-06, 'lr_base2': 0.0001, 'num_heads': 4, 'num_random_features': 256, 'num_transformer_layers': 2, 'optimizer': 'adamw', 'output_length': 512, 'output_length_ATAC': 16384, 'output_res': 128, 'pointwise_dropout_rate': 0.1, 'predict_masked_atac_bool': True, 'rectify': True, 'sonnet_weights_bool': True, 'stable_variant': False, 'use_atac': True, 'use_global_acc': True, 'wd_1_frac': 0.001, 'wd_2_frac': 0.01}
2023-03-08 17:18:24,557 INFO    Thread-2  :4529 [wandb_init.py:init():636] updated telemetry
2023-03-08 17:18:24,586 INFO    Thread-2  :4529 [wandb_init.py:init():668] communicating run to backend with 30 second timeout
2023-03-08 17:18:24,741 INFO    Thread-2  :4529 [wandb_run.py:_on_init():1982] communicating current version
2023-03-08 17:18:24,826 INFO    Thread-2  :4529 [wandb_run.py:_on_init():1986] got version response upgrade_message: "wandb version 0.13.11 is available!  To upgrade, please run:\n $ pip install wandb --upgrade"

2023-03-08 17:18:24,826 INFO    Thread-2  :4529 [wandb_init.py:init():700] starting run threads in backend
2023-03-08 17:18:29,841 INFO    Thread-2  :4529 [wandb_run.py:_console_start():1962] atexit reg
2023-03-08 17:18:29,841 INFO    Thread-2  :4529 [wandb_run.py:_redirect():1820] redirect: SettingsConsole.WRAP_RAW
2023-03-08 17:18:29,842 INFO    Thread-2  :4529 [wandb_run.py:_redirect():1885] Wrapping output streams.
2023-03-08 17:18:29,842 INFO    Thread-2  :4529 [wandb_run.py:_redirect():1907] Redirects installed.
2023-03-08 17:18:29,843 INFO    Thread-2  :4529 [wandb_init.py:init():732] run started, returning control to user process
2023-03-08 17:18:29,844 INFO    Thread-2  :4529 [wandb_config.py:__setitem__():149] config set tpu = node-8 - <bound method Run._config_callback of <wandb.sdk.wandb_run.Run object at 0x7fa2b371a290>>
2023-03-08 17:18:29,844 INFO    Thread-2  :4529 [wandb_run.py:_config_callback():1152] config_cb tpu node-8 None
2023-03-08 17:18:29,844 INFO    Thread-2  :4529 [wandb_config.py:__setitem__():149] config set gcs_path = gs://picard-testing-176520/genformer_atac_rampage_globalacc_conv_rpgc_5prime_65k - <bound method Run._config_callback of <wandb.sdk.wandb_run.Run object at 0x7fa2b371a290>>
2023-03-08 17:18:29,844 INFO    Thread-2  :4529 [wandb_run.py:_config_callback():1152] config_cb gcs_path gs://picard-testing-176520/genformer_atac_rampage_globalacc_conv_rpgc_5prime_65k None
2023-03-08 17:18:29,845 INFO    Thread-2  :4529 [wandb_config.py:__setitem__():149] config set gcs_path_holdout = gs://picard-testing-176520/genformer_atac_rampage_globalacc_conv_rpgc_5prime_65k_holdout - <bound method Run._config_callback of <wandb.sdk.wandb_run.Run object at 0x7fa2b371a290>>
2023-03-08 17:18:29,845 INFO    Thread-2  :4529 [wandb_run.py:_config_callback():1152] config_cb gcs_path_holdout gs://picard-testing-176520/genformer_atac_rampage_globalacc_conv_rpgc_5prime_65k_holdout None
2023-03-08 17:18:29,845 INFO    Thread-2  :4529 [wandb_config.py:__setitem__():149] config set gcs_path_TSS = gs://picard-testing-176520/genformer_atac_rampage_globalacc_conv_rpgc_TSS_5prime_65k - <bound method Run._config_callback of <wandb.sdk.wandb_run.Run object at 0x7fa2b371a290>>
2023-03-08 17:18:29,845 INFO    Thread-2  :4529 [wandb_run.py:_config_callback():1152] config_cb gcs_path_TSS gs://picard-testing-176520/genformer_atac_rampage_globalacc_conv_rpgc_TSS_5prime_65k None
2023-03-08 17:18:29,845 INFO    Thread-2  :4529 [wandb_config.py:__setitem__():149] config set gcs_path_TSS_holdout = gs://picard-testing-176520/genformer_atac_rampage_globalacc_conv_rpgc_TSS_5prime_65k_holdout - <bound method Run._config_callback of <wandb.sdk.wandb_run.Run object at 0x7fa2b371a290>>
2023-03-08 17:18:29,845 INFO    Thread-2  :4529 [wandb_run.py:_config_callback():1152] config_cb gcs_path_TSS_holdout gs://picard-testing-176520/genformer_atac_rampage_globalacc_conv_rpgc_TSS_5prime_65k_holdout None
2023-03-08 17:18:29,846 INFO    Thread-2  :4529 [wandb_config.py:__setitem__():149] config set num_epochs = 100 - <bound method Run._config_callback of <wandb.sdk.wandb_run.Run object at 0x7fa2b371a290>>
2023-03-08 17:18:29,846 INFO    Thread-2  :4529 [wandb_run.py:_config_callback():1152] config_cb num_epochs 100 None
2023-03-08 17:18:29,846 INFO    Thread-2  :4529 [wandb_config.py:__setitem__():149] config set train_examples = 1000 - <bound method Run._config_callback of <wandb.sdk.wandb_run.Run object at 0x7fa2b371a290>>
2023-03-08 17:18:29,846 INFO    Thread-2  :4529 [wandb_run.py:_config_callback():1152] config_cb train_examples 1000 None
2023-03-08 17:18:29,846 INFO    Thread-2  :4529 [wandb_config.py:__setitem__():149] config set val_examples = 150 - <bound method Run._config_callback of <wandb.sdk.wandb_run.Run object at 0x7fa2b371a290>>
2023-03-08 17:18:29,846 INFO    Thread-2  :4529 [wandb_run.py:_config_callback():1152] config_cb val_examples 150 None
2023-03-08 17:18:29,847 INFO    Thread-2  :4529 [wandb_config.py:__setitem__():149] config set val_examples_ho = 150 - <bound method Run._config_callback of <wandb.sdk.wandb_run.Run object at 0x7fa2b371a290>>
2023-03-08 17:18:29,847 INFO    Thread-2  :4529 [wandb_run.py:_config_callback():1152] config_cb val_examples_ho 150 None
2023-03-08 17:18:29,847 INFO    Thread-2  :4529 [wandb_config.py:__setitem__():149] config set val_examples_TSS = 150 - <bound method Run._config_callback of <wandb.sdk.wandb_run.Run object at 0x7fa2b371a290>>
2023-03-08 17:18:29,847 INFO    Thread-2  :4529 [wandb_run.py:_config_callback():1152] config_cb val_examples_TSS 150 None
2023-03-08 17:18:29,847 INFO    Thread-2  :4529 [wandb_config.py:__setitem__():149] config set val_examples_TSS_ho = 150 - <bound method Run._config_callback of <wandb.sdk.wandb_run.Run object at 0x7fa2b371a290>>
2023-03-08 17:18:29,847 INFO    Thread-2  :4529 [wandb_run.py:_config_callback():1152] config_cb val_examples_TSS_ho 150 None
2023-03-08 17:18:29,848 INFO    Thread-2  :4529 [wandb_config.py:__setitem__():149] config set batch_size = 4 - <bound method Run._config_callback of <wandb.sdk.wandb_run.Run object at 0x7fa2b371a290>>
2023-03-08 17:18:29,848 INFO    Thread-2  :4529 [wandb_run.py:_config_callback():1152] config_cb batch_size 4 None
2023-03-08 17:18:29,848 INFO    Thread-2  :4529 [wandb_config.py:__setitem__():149] config set warmup_frac = 0.005 - <bound method Run._config_callback of <wandb.sdk.wandb_run.Run object at 0x7fa2b371a290>>
2023-03-08 17:18:29,848 INFO    Thread-2  :4529 [wandb_run.py:_config_callback():1152] config_cb warmup_frac 0.005 None
2023-03-08 17:18:29,848 INFO    Thread-2  :4529 [wandb_config.py:__setitem__():149] config set patience = 50 - <bound method Run._config_callback of <wandb.sdk.wandb_run.Run object at 0x7fa2b371a290>>
2023-03-08 17:18:29,848 INFO    Thread-2  :4529 [wandb_run.py:_config_callback():1152] config_cb patience 50 None
2023-03-08 17:18:29,849 INFO    Thread-2  :4529 [wandb_config.py:__setitem__():149] config set min_delta = 5e-06 - <bound method Run._config_callback of <wandb.sdk.wandb_run.Run object at 0x7fa2b371a290>>
2023-03-08 17:18:29,849 INFO    Thread-2  :4529 [wandb_run.py:_config_callback():1152] config_cb min_delta 5e-06 None
2023-03-08 17:18:29,849 INFO    Thread-2  :4529 [wandb_config.py:__setitem__():149] config set model_save_dir = gs://picard-testing-176520/paired_rampage_atac/genformer/models - <bound method Run._config_callback of <wandb.sdk.wandb_run.Run object at 0x7fa2b371a290>>
2023-03-08 17:18:29,849 INFO    Thread-2  :4529 [wandb_run.py:_config_callback():1152] config_cb model_save_dir gs://picard-testing-176520/paired_rampage_atac/genformer/models None
2023-03-08 17:18:29,849 INFO    Thread-2  :4529 [wandb_config.py:__setitem__():149] config set model_save_basename = aformer_baseline - <bound method Run._config_callback of <wandb.sdk.wandb_run.Run object at 0x7fa2b371a290>>
2023-03-08 17:18:29,850 INFO    Thread-2  :4529 [wandb_run.py:_config_callback():1152] config_cb model_save_basename aformer_baseline None
2023-03-08 17:18:29,850 INFO    Thread-2  :4529 [wandb_config.py:__setitem__():149] config set max_shift = 10 - <bound method Run._config_callback of <wandb.sdk.wandb_run.Run object at 0x7fa2b371a290>>
2023-03-08 17:18:29,850 INFO    Thread-2  :4529 [wandb_run.py:_config_callback():1152] config_cb max_shift 10 None
2023-03-08 17:18:29,850 INFO    Thread-2  :4529 [wandb_config.py:__setitem__():149] config set inits_type = enformer_conv - <bound method Run._config_callback of <wandb.sdk.wandb_run.Run object at 0x7fa2b371a290>>
2023-03-08 17:18:29,850 INFO    Thread-2  :4529 [wandb_run.py:_config_callback():1152] config_cb inits_type enformer_conv None
2023-03-08 17:18:29,850 INFO    Thread-2  :4529 [wandb_config.py:__setitem__():149] config set crop_size = 100 - <bound method Run._config_callback of <wandb.sdk.wandb_run.Run object at 0x7fa2b371a290>>
2023-03-08 17:18:29,851 INFO    Thread-2  :4529 [wandb_run.py:_config_callback():1152] config_cb crop_size 100 None
2023-03-08 17:18:29,853 INFO    Thread-2  :4529 [wandb_run.py:_config_callback():1152] config_cb None None {'train_steps': 31}
2023-03-08 17:18:29,853 INFO    Thread-2  :4529 [wandb_run.py:_config_callback():1152] config_cb None None {'val_steps': 4}
2023-03-08 17:18:29,854 INFO    Thread-2  :4529 [wandb_run.py:_config_callback():1152] config_cb None None {'val_steps_ho': 4}
2023-03-08 17:18:29,854 INFO    Thread-2  :4529 [wandb_run.py:_config_callback():1152] config_cb None None {'val_steps_TSS': 4}
2023-03-08 17:18:29,854 INFO    Thread-2  :4529 [wandb_run.py:_config_callback():1152] config_cb None None {'val_steps_TSS_ho': 4}
2023-03-08 17:18:29,855 INFO    Thread-2  :4529 [wandb_run.py:_config_callback():1152] config_cb None None {'total_steps': 31}
2023-03-08 17:18:53,794 INFO    Thread-2  :4529 [wandb_run.py:_config_callback():1152] config_cb None None {}
